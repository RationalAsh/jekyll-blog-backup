---
layout: post
title: Using the ESP8266 WiFi module with an Arduino
date: '2014-12-08T21:25:00.001+05:30'
author: Ashwin Narayan
comments: true
tags:
- electronics
- cool stuff
- fun
- arduino
- technical
modified_time: '2015-10-05T15:34:03.118+05:30'
thumbnail: http://3.bp.blogspot.com/-M1JVT2Ekyag/VIUvjfEBUnI/AAAAAAAACLk/Fp3y0a56W-k/s72-c/ESP8266.jpg
blogger_id: tag:blogger.com,1999:blog-259194268438499485.post-4288119121947839866
blogger_orig_url: http://ashwinnarayan.blogspot.com/2014/12/using-esp8266-wifi-module-with-arduino.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">So I was pretty excited when I discovered the new cheap ESP8266 wifi module. It seemed too good to be true. I kept feeling that it's got way too many features for it's cost. There had to be a catch somewhere.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-M1JVT2Ekyag/VIUvjfEBUnI/AAAAAAAACLk/Fp3y0a56W-k/s1600/ESP8266.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://3.bp.blogspot.com/-M1JVT2Ekyag/VIUvjfEBUnI/AAAAAAAACLk/Fp3y0a56W-k/s1600/ESP8266.jpg" width="480" /></a></div><br />But no! I had mine delivered to me a couple of days ago and it's the real thing! Of course, it's true that it's a bit difficult to get it working as the documentation available is mostly in Chinese but there are plenty of people working on a translation. I had a little trouble getting the thing working properly. So I'll give a short tutorial on how to get the module working with an Arduino so that others find it easier.<br /><br />First of all, here's the pinout of the module:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-GIZ66lqtmoo/VIUwsQOs9VI/AAAAAAAACLs/aKBNJ-Qlvms/s1600/esp8266-pinout_etch_copper_top.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="376" src="http://3.bp.blogspot.com/-GIZ66lqtmoo/VIUwsQOs9VI/AAAAAAAACLs/aKBNJ-Qlvms/s1600/esp8266-pinout_etch_copper_top.png" width="640" /></a></div>That's the pinout when looking at the module from the side of the antenna. The antenna is that crazy trace that looks like a square wave.<br /><br />The module works on 3.3v. So wire up the Vcc pin of the module to the 3.3v pin of the Arduino.<br />GND goes to ground.<br />Both RST and CH_PD also goes to 3.3v.<br /><br />Now here's the tricky bit. The arduino is fine with reading incoming 3.3v signals on its digital input pins but the ESP8266 is NOT ok with incoming 5V signals from the Arduino. So use a simple voltage divider. (1k, 2k resistor) to step down the 5V signal from Arduino to 3.3V.<br /><br />Another point to note: The RXD of the ESP8266 goes to the RX pin of the Arduino (pin 0) and the TXD of the ESP8266 goes to the TX pin of the Arduino (pin 1). It looks like the Arduino has the labels the other way round. This is because when the Atmega IC is removed, the TX and RX pins are the RX and TX pins of the USB to UART bridge. When the IC is actually in the socket, I suspect that the TX of the module should go to the RX and the RX of the module to the TX of the Arduino board.<br /><br />I then removed the Atmega328 IC from the Arduino's socket and turned on the power. You should see a red LED light up on the ESP8266 indicating that the board is powered. A blue LED should briefly flash. That blue LED indicates serial communication. Now go to the Arduino IDE and open up the Serial monitor. Set the line ending to "Both NL and CR".<br /><br />Some ESP8266 modules come with old firmware that requires you to set the baud rate to 115200. Some modules come with the new version of the firmware and a default baud rate of 9600. So try out different baud rates if you get gibberish on the monitor. Once you find the correct baud rate try typing in "AT+RST" into the serial monitor. You should get some output. Here's what I get:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-_MrVtHdfuqw/VIU7S6CyqdI/AAAAAAAACL8/QoiFuYLTvow/s1600/Screensho%2Bfrom%2BMon%2BDec%2B%2B8%2B11%3A15%3A13%2BIST%2B2014.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="138" src="http://3.bp.blogspot.com/-_MrVtHdfuqw/VIU7S6CyqdI/AAAAAAAACL8/QoiFuYLTvow/s1600/Screensho%2Bfrom%2BMon%2BDec%2B%2B8%2B11%3A15%3A13%2BIST%2B2014.png" width="640" /></a></div><br />The wifi module is controlled using "AT commands". There is a list of the available commands <a href="https://nurdspace.nl/ESP8266#Commands" target="_blank">here</a>. Say you want to connect to your home wifi network.<br /><br />First type in "AT+CWMODE?". This gives you the current mode the module is operating in. You need to set it to mode 3 if you want to connect to your home router. To set the mode to 3 use the command, "AT+CWMODE=3".<br /><br />Then type in "AT+CWLAP"(List Access Points). This will give you a list of available wifi networks. Hopefully, you see yours on the list.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-rnEGzPAWKAY/VIXI1PLswLI/AAAAAAAACMM/nxZf3yX6aqU/s1600/Screensho%2Bfrom%2BMon%2BDec%2B%2B8%2B21%3A19%3A31%2BIST%2B2014.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="244" src="http://1.bp.blogspot.com/-rnEGzPAWKAY/VIXI1PLswLI/AAAAAAAACMM/nxZf3yX6aqU/s1600/Screensho%2Bfrom%2BMon%2BDec%2B%2B8%2B21%3A19%3A31%2BIST%2B2014.png" width="640" /></a></div><br /><br />To join an Access Point I have to use the command "AT+CWJAP"(Join Access Point).<br />The syntax is "AT+CWJAP="SSID<ssid>","password<password>".</password></ssid><br /><br />And there you have it! You've connected to your router with the ESP8266. There's all sorts of cool things you can do after this. You can set up a TCP or UDP server and start streaming sensor data for example. Maybe I'll write about that in the next blogpost.</div>
